<!-- course.handlebars -->
<script>
    let isFormDirty = false;
</script>
<div class="side-btn-wrapper lg:hidden">
    <button id="left-side-button" onclick='panMainContentLeft()'
            class="flex items-center bg-button-default hover:bg-button-hover active:bg-button-active focus-visible:outline-system-focus focus-visible:border-solid focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 text-primary-100 py-4 pl-4 pr-8 rounded-r-full">
        <i class="material-symbols-outlined cursor-pointer text-xxxl text-brand_red  transition ease-in-out duration-1000"
           aria-hidden="true">chevron_right</i>
        Kursuse menüü
    </button>
    <button id="right-side-button" onclick='panMainContentRight()'
            class="hidden lg:flex items-center bg-button-default hover:bg-button-hover active:bg-button-active focus-visible:outline-system-focus focus-visible:border-solid focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 text-primary-100 py-4 pl-8 pr-4 rounded-l-full">
        Lehekülje menüü
        <i class="material-symbols-outlined cursor-pointer text-xxxl text-brand_red  transition ease-in-out duration-1000"
           aria-hidden="true">chevron_left</i>
    </button>
</div>

<div class="main-wrapper flex flex-row grow justify-between lg:px-6 lg:left-pan lg:right-pan">
    <aside class="left-side-menu">
        <!-- Refers to sidebar-left-course.handlebars fail in /partials folder -->
        {{> sidebar-left.course-edit }}
    </aside>

    <main id="main-content" class="main px-4 py-20">
        <!-- Renders dynamic partial set by controller -->
        {{> (whichPartial partial) }}
    </main>
    <aside class="right-side-menu p-2">
        {{> sidebar-right.course-edit }}
    </aside>
</div>
<div id="modal" class="hidden fixed top-0 left-0 w-full h-full items-center justify-center custom-backdrop z-10">
    <div class="card p-8 rounded shadow-md custom-modal-content bg-primary">
        <p class="mb-4 text-lg" id="delMsg"></p>
        <div class="flex justify-end">
            <button class="btn btn-primary mr-4" onclick="cancelAction()">Katkesta</button>
            <button class="btn btn-secondary" id="delOK">Kustuta</button>
        </div>
    </div>
</div>
<script>
    const form = document.getElementById('courseEditForm');
    form.addEventListener('input', () => {
        isFormDirty = true;
        document.getElementById('saveBtn').classList.add('border-4', 'border-system-focus');
    });

    function submitEditForm() {
        window.removeEventListener('beforeunload', beforeUnloadHandler); // Remove the listener
        form.submit();
    }

    function cancelAction() {
        document.getElementById('modal').style.display = 'none';
    }

    const beforeUnloadHandler = (event) => {
        if (isFormDirty) {
            event.returnValue = 'Are you sure you want to leave? You have unsaved changes.'; // For older browsers
            return 'Are you sure you want to leave? You have unsaved changes.'; // Standard
        }
    };

    window.addEventListener('beforeunload', beforeUnloadHandler);
</script>

